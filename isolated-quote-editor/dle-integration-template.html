<!--
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  QUOTE EDITOR - DLE INTEGRATION TEMPLATE
  Shadow DOM Isolated Version

  Ğ˜ĞĞ¡Ğ¢Ğ Ğ£ĞšĞ¦Ğ˜Ğ¯:
  1. Ğ¡ĞºĞ¾Ğ¿Ğ¸Ñ€ÑƒĞ¹Ñ‚Ğµ ÑÑ‚Ğ¾Ñ‚ Ñ„Ğ°Ğ¹Ğ» Ğ² Ğ²Ğ°Ñˆ DLE ÑˆĞ°Ğ±Ğ»Ğ¾Ğ½ (fullstory.tpl Ğ¸Ğ»Ğ¸ Ğ´Ñ€ÑƒĞ³Ğ¾Ğ¹)
  2. Ğ’ÑÑ‚Ğ°Ğ²ÑŒÑ‚Ğµ Ğ²Ğ°ÑˆĞ¸ ÑÑ‚Ğ¸Ğ»Ğ¸ Ğ² ÑĞµĞºÑ†Ğ¸Ñ STYLES
  3. Ğ’ÑÑ‚Ğ°Ğ²ÑŒÑ‚Ğµ Ğ²Ğ°Ñˆ HTML Ğ² ÑĞµĞºÑ†Ğ¸Ñ HTML
  4. Ğ’ÑÑ‚Ğ°Ğ²ÑŒÑ‚Ğµ Ğ²Ğ°Ñˆ JavaScript Ğ² ÑĞµĞºÑ†Ğ¸Ñ JAVASCRIPT
  5. Ğ“Ğ¾Ñ‚Ğ¾Ğ²Ğ¾! Ğ ĞµĞ´Ğ°ĞºÑ‚Ğ¾Ñ€ Ğ¿Ğ¾Ğ»Ğ½Ğ¾ÑÑ‚ÑŒÑ Ğ¸Ğ·Ğ¾Ğ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½ Ğ¾Ñ‚ DLE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-->

<!-- ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡Ğ°ĞµĞ¼ Ğ²Ğ½ĞµÑˆĞ½Ğ¸Ğµ Ğ±Ğ¸Ğ±Ğ»Ğ¸Ğ¾Ñ‚ĞµĞºĞ¸ ĞŸĞ•Ğ Ğ•Ğ” Shadow DOM -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

<!-- ĞšĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€ Ğ´Ğ»Ñ Ğ¸Ğ·Ğ¾Ğ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğ³Ğ¾ Ñ€ĞµĞ´Ğ°ĞºÑ‚Ğ¾Ñ€Ğ° -->
<div id="quote-editor-isolated-container"></div>

<script>
(function() {
    'use strict';

    console.log('ğŸš€ Initializing Quote Editor (Shadow DOM)...');

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // 1. Ğ¡ĞĞ—Ğ”ĞĞĞ˜Ğ• SHADOW DOM
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    const container = document.getElementById('quote-editor-isolated-container');

    if (!container) {
        console.error('âŒ Container #quote-editor-isolated-container not found!');
        return;
    }

    const shadowRoot = container.attachShadow({ mode: 'open' });

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // 2. Ğ’Ğ¡Ğ¢ĞĞ’ĞšĞ Ğ¡Ğ¢Ğ˜Ğ›Ğ•Ğ™ Ğ˜ HTML
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    shadowRoot.innerHTML = `
        <!-- ============================================================= -->
        <!-- STYLES - Ğ’ÑÑ‚Ğ°Ğ²ÑŒÑ‚Ğµ ÑÑĞ´Ğ° Ğ’Ğ¡Ğ• Ğ²Ğ°ÑˆĞ¸ ÑÑ‚Ğ¸Ğ»Ğ¸                        -->
        <!-- ============================================================= -->
        <style>
            /*
               Ğ˜ĞĞ¡Ğ¢Ğ Ğ£ĞšĞ¦Ğ˜Ğ¯:
               Ğ¡ĞºĞ¾Ğ¿Ğ¸Ñ€ÑƒĞ¹Ñ‚Ğµ Ğ’Ğ•Ğ¡Ğ¬ Ğ±Ğ»Ğ¾Ğº <style> Ğ¸Ğ· Ğ²Ğ°ÑˆĞµĞ³Ğ¾ Ğ¾Ñ€Ğ¸Ğ³Ğ¸Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ HTML
               Ğ¸ Ğ²ÑÑ‚Ğ°Ğ²ÑŒÑ‚Ğµ ÑÑĞ´Ğ° (Ğ±ĞµĞ· Ñ‚ĞµĞ³Ğ¾Ğ² <style></style>)
            */

            .main-ctr {
                margin: 0 auto;
                background: white;
                padding: 10px;
                box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            }

            .hdr {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                padding: 5px 20px;
                text-align: center;
                margin-bottom: 10px;
            }

            /*
               ... Ğ’Ğ¡Ğ• ĞĞ¡Ğ¢ĞĞ›Ğ¬ĞĞ«Ğ• Ğ¡Ğ¢Ğ˜Ğ›Ğ˜ ...
               (Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€Ğ½Ğ¾ 8500 ÑÑ‚Ñ€Ğ¾Ğº)
            */

        </style>

        <!-- ============================================================= -->
        <!-- HTML - Ğ’ÑÑ‚Ğ°Ğ²ÑŒÑ‚Ğµ ÑÑĞ´Ğ° Ğ²ĞµÑÑŒ HTML Ñ€ĞµĞ´Ğ°ĞºÑ‚Ğ¾Ñ€Ğ°                     -->
        <!-- ============================================================= -->

        <!--
           Ğ˜ĞĞ¡Ğ¢Ğ Ğ£ĞšĞ¦Ğ˜Ğ¯:
           Ğ¡ĞºĞ¾Ğ¿Ğ¸Ñ€ÑƒĞ¹Ñ‚Ğµ Ğ²ĞµÑÑŒ HTML-ĞºĞ¾Ğ´ Ñ€ĞµĞ´Ğ°ĞºÑ‚Ğ¾Ñ€Ğ° Ğ½Ğ°Ñ‡Ğ¸Ğ½Ğ°Ñ Ñ <div class="main-ctr">
           Ğ¸ Ğ²ÑÑ‚Ğ°Ğ²ÑŒÑ‚Ğµ ÑÑĞ´Ğ°
        -->

        <div class="main-ctr">
            <div class="hdr">
                <h1>ğŸ¨ Ğ£Ğ½Ğ¸Ğ²ĞµÑ€ÑĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ñ€ĞµĞ´Ğ°ĞºÑ‚Ğ¾Ñ€ Ñ†Ğ¸Ñ‚Ğ°Ñ‚</h1>
                <p>Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ²Ğ°Ğ¹Ñ‚Ğµ ĞºÑ€Ğ°ÑĞ¸Ğ²Ñ‹Ğµ Ñ†Ğ¸Ñ‚Ğ°Ñ‚Ñ‹ Ñ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸ĞµĞ¼ Ğ¸ Ğ¿Ğ¾Ğ»Ğ½Ñ‹Ğ¼ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»ĞµĞ¼ Ğ½Ğ°Ğ´ Ğ¾Ñ„Ğ¾Ñ€Ğ¼Ğ»ĞµĞ½Ğ¸ĞµĞ¼</p>
            </div>

            <!-- Canvas Ğ´Ğ»Ñ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğ¹ -->
            <canvas id="qcanvas" width="800" height="600"></canvas>

            <!-- Ğ­Ğ»ĞµĞ¼ĞµĞ½Ñ‚Ñ‹ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ -->
            <div class="quote-gen">
                <textarea id="txtQuote" placeholder="Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ñ‚ĞµĞºÑÑ‚ Ğ²Ğ°ÑˆĞµĞ¹ Ñ†Ğ¸Ñ‚Ğ°Ñ‚Ñ‹..."></textarea>
                <input type="text" id="writer" placeholder="ĞĞ²Ñ‚Ğ¾Ñ€ Ñ†Ğ¸Ñ‚Ğ°Ñ‚Ñ‹" value="">

                <!-- ... Ğ²ĞµÑÑŒ Ğ¾ÑÑ‚Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¹ HTML ... -->
            </div>

            <!-- ĞšĞ½Ğ¾Ğ¿ĞºĞ¸ Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğ¹ -->
            <div class="action-btns">
                <button class="btn" id="downloadBtn">ğŸ’¿ Ğ¡ĞºĞ°Ñ‡Ğ°Ñ‚ÑŒ</button>
                <!-- ... Ğ¾ÑÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ ĞºĞ½Ğ¾Ğ¿ĞºĞ¸ ... -->
            </div>
        </div>
    `;

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // 3. ĞĞ”ĞĞŸĞ¢Ğ˜Ğ ĞĞ’ĞĞĞĞ«Ğ™ JAVASCRIPT
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    // Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµĞ¼ Ğ¾Ğ±ÑŠĞµĞºÑ‚ QE (Quote Editor)
    const QE = {};

    // â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    // â”‚ Ğ’ĞĞ–ĞĞ: ĞĞ´Ğ°Ğ¿Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğµ ÑĞµĞ»ĞµĞºÑ‚Ğ¾Ñ€Ñ‹ Ğ´Ğ»Ñ Shadow DOM                  â”‚
    // â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    QE.get = function(id) {
        return shadowRoot.getElementById(id);
    };

    QE.qs = function(selector) {
        return shadowRoot.querySelector(selector);
    };

    QE.qsAll = function(selector) {
        return shadowRoot.querySelectorAll(selector);
    };

    // â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    // â”‚ Ğ¡ĞĞ¡Ğ¢ĞĞ¯ĞĞ˜Ğ• ĞŸĞ Ğ˜Ğ›ĞĞ–Ğ•ĞĞ˜Ğ¯                                             â”‚
    // â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    QE.state = {
        bgImg: null,
        origBgImg: null,
        isDragging: false,
        isResizing: false,
        draggedEl: null,
        dragOffset: { x: 0, y: 0 },
        resizeDir: null,
        startCoords: { x: 0, y: 0 },
        activeBgTab: 'color',
        selectedGradient: null,
        genImgTimeout: null,
        animFrameId: null,
        intMode: false,
        isAutoScale: true,
        isLayoutFixed: false,
        txtBox: {
            x: 200,
            y: 200,
            width: 400,
            height: 200
        },
        cropMode: false,
        isSelectingCrop: false,
        cropSel: {
            startX: 0,
            startY: 0,
            endX: 0,
            endY: 0,
            active: false
        },
        cropBox: {
            x: 0,
            y: 0,
            width: 800,
            height: 600
        },
        imgTransform: {
            zoom: 1,
            rotation: 0,
            flipH: false,
            flipV: false,
            offsetX: 0,
            offsetY: 0
        },
        isDraggingCrop: false,
        isResizingCrop: false,
        cropResizeHandle: null,
        currentAspectRatio: 'free',
        aspectRatioLocked: false,
        compMode: false,
        compSet: {
            type: 'percent',
            percent: 100,
            maxWidth: 800,
            maxHeight: 600,
            originalWidth: 0,
            originalHeight: 0
        },
        txtPos: {
            quote: { x: null, y: null },
            writer: { x: null, y: null },
            source: { x: null, y: null },
            date: { x: null, y: null }
        },
        txtAreas: {
            quote: { x: 0, y: 0, width: 0, height: 0 },
            writer: { x: 0, y: 0, width: 0, height: 0 },
            source: { x: 0, y: 0, width: 0, height: 0 },
            date: { x: 0, y: 0, width: 0, height: 0 }
        },
        txtFmt: {
            bold: false,
            italic: false,
            fontFamily: 'Georgia',
            fontSize: 40,
            rotation: 0
        },
        editingTouchStartHandler: null,
        editingTouchMoveHandler: null,
        mobileDragTarget: null,
        filtersEnabled: false,
        stickers: [],
        selectedStickerId: null,
        isResizingSticker: false,
        stickerGallery: {
            currentPage: 1,
            totalPages: 1,
            currentCategory: 'all',
            currentSearch: ''
        },
        disableMobileDragBlock: false
    };

    // â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    // â”‚ Ğ¤Ğ˜Ğ›Ğ¬Ğ¢Ğ Ğ« Ğ˜Ğ—ĞĞ‘Ğ ĞĞ–Ğ•ĞĞ˜Ğ¯                                              â”‚
    // â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    QE.filters = {
        brightness: 100,
        contrast: 100,
        blur: 0,
        saturation: 100,

        apply: function(ctx, canvas) {
            ctx.filter = `brightness(${this.brightness}%) contrast(${this.contrast}%) blur(${this.blur}px) saturate(${this.saturation}%)`;
        }
    };

    // â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    // â”‚ Ğ’Ğ¡Ğ• ĞœĞ•Ğ¢ĞĞ”Ğ« QE                                                    â”‚
    // â”‚                                                                  â”‚
    // â”‚ Ğ˜ĞĞ¡Ğ¢Ğ Ğ£ĞšĞ¦Ğ˜Ğ¯:                                                      â”‚
    // â”‚ Ğ¡ĞºĞ¾Ğ¿Ğ¸Ñ€ÑƒĞ¹Ñ‚Ğµ ÑÑĞ´Ğ° Ğ’Ğ¡Ğ• Ğ¼ĞµÑ‚Ğ¾Ğ´Ñ‹ Ğ¸Ğ· Ğ²Ğ°ÑˆĞµĞ³Ğ¾ Ğ¾Ñ€Ğ¸Ğ³Ğ¸Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ ĞºĞ¾Ğ´Ğ°         â”‚
    // â”‚ ĞĞ½Ğ¸ Ğ±ÑƒĞ´ÑƒÑ‚ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ñ‚ÑŒ Ğ±Ğ»Ğ°Ğ³Ğ¾Ğ´Ğ°Ñ€Ñ Ğ°Ğ´Ğ°Ğ¿Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¼ ÑĞµĞ»ĞµĞºÑ‚Ğ¾Ñ€Ğ°Ğ¼          â”‚
    // â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    QE.genImg = function(forExport = false) {
        // Ğ’Ğ°Ñˆ ĞºĞ¾Ğ´ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ
        const canvas = QE.get('qcanvas');
        if (!canvas) return;

        // ... Ğ²ĞµÑÑŒ Ğ¾ÑÑ‚Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¹ ĞºĞ¾Ğ´ ...
    };

    QE.showErr = function(msg) {
        const errDiv = QE.get('errMsg');
        if (errDiv) {
            errDiv.textContent = msg;
            errDiv.classList.add('show');
            setTimeout(() => {
                errDiv.classList.remove('show');
            }, 5000);
        }
    };

    QE.showSuccess = function(msg) {
        const successDiv = QE.get('successMsg');
        if (successDiv) {
            successDiv.textContent = msg;
            successDiv.classList.add('show');
            setTimeout(() => {
                successDiv.classList.remove('show');
            }, 3000);
        }
    };

    // ... Ğ’Ğ¡Ğ• ĞĞ¡Ğ¢ĞĞ›Ğ¬ĞĞ«Ğ• ĞœĞ•Ğ¢ĞĞ”Ğ« QE ...
    // (Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€Ğ½Ğ¾ 5000-6000 ÑÑ‚Ñ€Ğ¾Ğº ĞºĞ¾Ğ´Ğ°)

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // 4. Ğ˜ĞĞ˜Ğ¦Ğ˜ĞĞ›Ğ˜Ğ—ĞĞ¦Ğ˜Ğ¯
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    // âŒ Ğ‘Ğ«Ğ›Ğ (Ğ² Ğ¾Ñ€Ğ¸Ğ³Ğ¸Ğ½Ğ°Ğ»Ğµ):
    // document.addEventListener('DOMContentLoaded', function() { ... });

    // âœ… Ğ¡Ğ¢ĞĞ›Ğ (Ğ´Ğ»Ñ Shadow DOM):
    (function initQuoteEditor() {
        console.log('ğŸ¨ Initializing Quote Editor core...');

        const canvasElement = QE.get('qcanvas');

        if (!canvasElement) {
            console.error('âŒ Canvas not found in Shadow DOM');
            return;
        }

        const isMobile = window.innerWidth <= 768;

        // Ğ“Ñ€Ğ°Ğ´Ğ¸ĞµĞ½Ñ‚Ñ‹
        const gradientData = [
            { id: 'gradient1', name: 'Ğ¤Ğ¸Ğ¾Ğ»ĞµÑ‚Ğ¾Ğ²Ñ‹Ğ¹', colors: ['#667eea', '#764ba2'] },
            { id: 'gradient2', name: 'Ğ Ğ¾Ğ·Ğ¾Ğ²Ñ‹Ğ¹', colors: ['#f093fb', '#f5576c'] },
            // ... Ğ²ÑĞµ Ğ³Ñ€Ğ°Ğ´Ğ¸ĞµĞ½Ñ‚Ñ‹ ...
        ];

        window.gradientData = gradientData;

        // Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ³Ñ€Ğ°Ğ´Ğ¸ĞµĞ½Ñ‚Ğ¾Ğ²
        const gradientContainer = QE.get('gradientPresets');
        if (gradientContainer) {
            gradientData.forEach(gradient => {
                const div = document.createElement('div');
                div.style.cssText = `
                    background: linear-gradient(135deg, ${gradient.colors[0]}, ${gradient.colors[1]});
                    height: 60px;
                    border-radius: 5px;
                    cursor: pointer;
                    transition: all 0.3s;
                    position: relative;
                    border: 2px solid transparent;
                `;
                div.dataset.gradient = gradient.id;
                div.title = gradient.name;

                div.addEventListener('click', function() {
                    gradientContainer.querySelectorAll('div').forEach(g => {
                        g.style.border = '2px solid transparent';
                        g.style.transform = 'scale(1)';
                    });

                    this.style.border = '2px solid #4CAF50';
                    this.style.transform = 'scale(0.95)';

                    QE.state.selectedGradient = this.dataset.gradient;
                    // QE.activateTab('gradient');
                    QE.genImg();
                });

                gradientContainer.appendChild(div);
            });
        }

        // ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸ĞºĞ¸ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹ canvas
        canvasElement.addEventListener('mousedown', QE.handleStart);
        canvasElement.addEventListener('mousemove', QE.handleMove);
        canvasElement.addEventListener('mouseup', QE.handleEnd);
        canvasElement.addEventListener('mouseleave', QE.handleEnd);

        // Touch ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ
        canvasElement.addEventListener('touchstart', QE.handleStart, { passive: false });
        canvasElement.addEventListener('touchmove', QE.handleMove, { passive: false });
        canvasElement.addEventListener('touchend', QE.handleEnd);

        // Ğ’Ğ¡Ğ¯ ĞĞ¡Ğ¢ĞĞ›Ğ¬ĞĞĞ¯ Ğ˜ĞĞ˜Ğ¦Ğ˜ĞĞ›Ğ˜Ğ—ĞĞ¦Ğ˜Ğ¯ Ğ¸Ğ· Ğ²Ğ°ÑˆĞµĞ³Ğ¾ DOMContentLoaded
        // ...

        // ĞŸĞµÑ€Ğ²Ğ°Ñ Ğ¾Ñ‚Ñ€Ğ¸ÑĞ¾Ğ²ĞºĞ°
        QE.genImg();

        console.log('âœ… Quote Editor initialized successfully');
    })();

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // 5. Ğ­ĞšĞ¡ĞŸĞĞ Ğ¢ Ğ”Ğ›Ğ¯ Ğ’ĞĞ•Ğ¨ĞĞ•Ğ“Ğ Ğ”ĞĞ¡Ğ¢Ğ£ĞŸĞ
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    window.QuoteEditorInstance = {
        shadowRoot: shadowRoot,
        QE: QE,

        // ĞœĞµÑ‚Ğ¾Ğ´Ñ‹ Ğ´Ğ»Ñ Ğ²Ğ½ĞµÑˆĞ½ĞµĞ³Ğ¾ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ°
        getCanvas: function() {
            return QE.get('qcanvas');
        },

        getQuoteText: function() {
            const quoteEl = QE.get('txtQuote');
            return quoteEl ? quoteEl.value : '';
        },

        getWriter: function() {
            const writerEl = QE.get('writer');
            return writerEl ? writerEl.value : '';
        },

        setQuoteText: function(text) {
            const quoteEl = QE.get('txtQuote');
            if (quoteEl) {
                quoteEl.value = text;
                QE.genImg();
            }
        },

        setWriter: function(name) {
            const writerEl = QE.get('writer');
            if (writerEl) {
                writerEl.value = name;
                QE.genImg();
            }
        },

        regenerate: function() {
            QE.genImg();
        },

        downloadImage: function() {
            if (QE.downloadImg) {
                QE.downloadImg();
            }
        },

        getImageDataURL: function(format = 'png', quality = 0.9) {
            const canvas = QE.get('qcanvas');
            if (!canvas) return null;

            const mimeType = format === 'png' ? 'image/png' :
                           format === 'jpg' ? 'image/jpeg' : 'image/webp';

            return canvas.toDataURL(mimeType, quality);
        }
    };

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // 6. Ğ“Ğ›ĞĞ‘ĞĞ›Ğ¬ĞĞ«Ğ• Ğ¤Ğ£ĞĞšĞ¦Ğ˜Ğ˜ (Ğ´Ğ»Ñ ÑĞ¾Ğ²Ğ¼ĞµÑÑ‚Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ Ñ DLE)
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    // Ğ•ÑĞ»Ğ¸ Ğ² Ğ²Ğ°ÑˆĞµĞ¼ DLE ÑˆĞ°Ğ±Ğ»Ğ¾Ğ½Ğµ ĞµÑÑ‚ÑŒ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸ Ñ‚Ğ¸Ğ¿Ğ° shareQuoteUniversal()
    // ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğµ Ğ´Ğ¾Ğ»Ğ¶Ğ½Ñ‹ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ñ‚ÑŒ ÑĞ½Ğ°Ñ€ÑƒĞ¶Ğ¸ Shadow DOM, Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»Ğ¸Ñ‚Ğµ Ğ¸Ñ… Ğ·Ğ´ĞµÑÑŒ:

    window.generateQuoteImage = function() {
        return window.QuoteEditorInstance.getCanvas();
    };

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // 7. ĞĞ‘Ğ ĞĞ‘ĞĞ¢ĞšĞ Ğ“Ğ›ĞĞ‘ĞĞ›Ğ¬ĞĞ«Ğ¥ Ğ¡ĞĞ‘Ğ«Ğ¢Ğ˜Ğ™
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    // ĞĞµĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğµ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ Ğ´Ğ¾Ğ»Ğ¶Ğ½Ñ‹ Ğ¾ÑÑ‚Ğ°Ğ²Ğ°Ñ‚ÑŒÑÑ Ğ½Ğ° document

    // Ğ’ÑÑ‚Ğ°Ğ²ĞºĞ° Ğ¸Ğ· Ğ±ÑƒÑ„ĞµÑ€Ğ° Ğ¾Ğ±Ğ¼ĞµĞ½Ğ°
    document.addEventListener('paste', function(e) {
        const activeElement = document.activeElement;

        // Ğ•ÑĞ»Ğ¸ Ñ„Ğ¾ĞºÑƒÑ Ğ² Ñ‚ĞµĞºÑÑ‚Ğ¾Ğ²Ğ¾Ğ¼ Ğ¿Ğ¾Ğ»Ğµ, Ñ€Ğ°Ğ·Ñ€ĞµÑˆĞ°ĞµĞ¼ ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ½ÑƒÑ Ğ²ÑÑ‚Ğ°Ğ²ĞºÑƒ
        if (activeElement && (activeElement.tagName === 'INPUT' ||
                              activeElement.tagName === 'TEXTAREA' ||
                              activeElement.tagName === 'SELECT')) {
            return;
        }

        // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼ Ğ½Ğ°Ğ»Ğ¸Ñ‡Ğ¸Ğµ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ Ğ² Ğ±ÑƒÑ„ĞµÑ€Ğµ
        if (e.clipboardData && e.clipboardData.items) {
            const items = e.clipboardData.items;

            for (let i = 0; i < items.length; i++) {
                if (items[i].type.indexOf('image') !== -1) {
                    e.preventDefault();

                    const blob = items[i].getAsFile();
                    if (blob && QE.loadImgFile) {
                        QE.loadImgFile(blob);
                    }

                    break;
                }
            }
        }
    });

    console.log('âœ… Quote Editor (Shadow DOM) fully initialized');

})();
</script>

<!--
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ĞšĞĞĞ•Ğ¦ Ğ¨ĞĞ‘Ğ›ĞĞĞ

  ĞŸĞ ĞĞ’Ğ•Ğ ĞĞ§ĞĞ«Ğ™ Ğ¡ĞŸĞ˜Ğ¡ĞĞš:
  â–¡ Ğ’ÑÑ‚Ğ°Ğ²Ğ¸Ğ»Ğ¸ Ğ²ÑĞµ ÑÑ‚Ğ¸Ğ»Ğ¸
  â–¡ Ğ’ÑÑ‚Ğ°Ğ²Ğ¸Ğ»Ğ¸ Ğ²ĞµÑÑŒ HTML
  â–¡ Ğ’ÑÑ‚Ğ°Ğ²Ğ¸Ğ»Ğ¸ Ğ²ĞµÑÑŒ JavaScript
  â–¡ ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡Ğ¸Ğ»Ğ¸ Ğ²Ğ½ĞµÑˆĞ½Ğ¸Ğµ Ğ±Ğ¸Ğ±Ğ»Ğ¸Ğ¾Ñ‚ĞµĞºĞ¸ (JSZip, FileSaver)
  â–¡ ĞŸÑ€Ğ¾Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ»Ğ¸ Ğ½Ğ° Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾Ğ¼ ÑĞµÑ€Ğ²ĞµÑ€Ğµ
  â–¡ Ğ£Ğ±ĞµĞ´Ğ¸Ğ»Ğ¸ÑÑŒ Ğ² Ğ¸Ğ·Ğ¾Ğ»ÑÑ†Ğ¸Ğ¸ ÑÑ‚Ğ¸Ğ»ĞµĞ¹

  ĞŸĞĞ›Ğ•Ğ—ĞĞ«Ğ• ĞšĞĞœĞĞĞ”Ğ« Ğ”Ğ›Ğ¯ ĞĞ¢Ğ›ĞĞ”ĞšĞ˜:
  console.log(window.QuoteEditorInstance.shadowRoot);
  console.log(window.QuoteEditorInstance.QE.state);
  window.QuoteEditorInstance.getQuoteText();
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-->
