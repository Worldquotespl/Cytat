# üìã –ü–æ—à–∞–≥–æ–≤–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –º–∏–≥—Ä–∞—Ü–∏–∏ –≤–∞—à–µ–≥–æ Quote Editor –≤ Shadow DOM

## üéØ –¶–µ–ª—å

–ü—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å –≤–∞—à –º–æ–Ω–æ–ª–∏—Ç–Ω—ã–π HTML —Ñ–∞–π–ª (~8500 —Å—Ç—Ä–æ–∫) –≤ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—É—é Shadow DOM –≤–µ—Ä—Å–∏—é –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ DLE.

---

## üìä –û–±–∑–æ—Ä –º–∏–≥—Ä–∞—Ü–∏–∏

**–ß—Ç–æ —É –≤–∞—Å —Å–µ–π—á–∞—Å:**
```
your-quote-editor.html
‚îú‚îÄ‚îÄ <style> (8530 —Å—Ç—Ä–æ–∫ CSS)
‚îú‚îÄ‚îÄ <div> (HTML —Ä–∞–∑–º–µ—Ç–∫–∞)
‚îî‚îÄ‚îÄ <script> (JavaScript –ª–æ–≥–∏–∫–∞)
```

**–ß—Ç–æ –ø–æ–ª—É—á–∏—Ç—Å—è:**
```
isolated-quote-editor/
‚îú‚îÄ‚îÄ styles –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã –≤ Shadow DOM
‚îú‚îÄ‚îÄ HTML –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω –≤ Shadow DOM
‚îî‚îÄ‚îÄ JavaScript –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Shadow Root
```

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (5 –º–∏–Ω—É—Ç)

### –í–∞—Ä–∏–∞–Ω—Ç A: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è

```bash
# 1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤–∞—à —Ñ–∞–π–ª –≤ —ç—Ç—É –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
cp /path/to/your-quote-editor.html ./original.html

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏
./convert.sh original.html

# 3. –û—Ç–∫—Ä–æ–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
# isolated-output.html - –≥–æ—Ç–æ–≤–∞—è Shadow DOM –≤–µ—Ä—Å–∏—è
```

### –í–∞—Ä–∏–∞–Ω—Ç B: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≥–æ—Ç–æ–≤–æ–≥–æ —à–∞–±–ª–æ–Ω–∞

```bash
# 1. –û—Ç–∫—Ä–æ–π—Ç–µ dle-integration-template.html

# 2. –ù–∞–π–¥–∏—Ç–µ —Å–µ–∫—Ü–∏—é STYLES
# 3. –í—Å—Ç–∞–≤—å—Ç–µ —Ç—É–¥–∞ –í–°–ï –≤–∞—à–∏ —Å—Ç–∏–ª–∏ (—Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏–∑ <style> —Ç–µ–≥–∞)

# 4. –ù–∞–π–¥–∏—Ç–µ —Å–µ–∫—Ü–∏—é HTML
# 5. –í—Å—Ç–∞–≤—å—Ç–µ —Ç—É–¥–∞ –≤–µ—Å—å –≤–∞—à HTML (—Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏–∑ <div class="main-ctr">)

# 6. –ù–∞–π–¥–∏—Ç–µ —Å–µ–∫—Ü–∏—é JAVASCRIPT
# 7. –í—Å—Ç–∞–≤—å—Ç–µ —Ç—É–¥–∞ –≤–µ—Å—å –≤–∞—à JavaScript

# 8. –ì–æ—Ç–æ–≤–æ! –§–∞–π–ª –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ DLE
```

---

## üìù –î–µ—Ç–∞–ª—å–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è (–ø–æ—à–∞–≥–æ–≤–æ)

### –®–ê–ì 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ñ–∞–π–ª–æ–≤ (10 –º–∏–Ω—É—Ç)

#### 1.1 –°–æ–∑–¥–∞–π—Ç–µ —Ä–∞–±–æ—á—É—é –∫–æ–ø–∏—é

```bash
# –°–æ–∑–¥–∞–π—Ç–µ backup –æ—Ä–∏–≥–∏–Ω–∞–ª–∞
cp your-quote-editor.html your-quote-editor.BACKUP.html

# –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª –¥–ª—è –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–∏
touch quote-editor-isolated.html
```

#### 1.2 –û—Ç–∫—Ä–æ–π—Ç–µ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª

–ù–∞–π–¥–∏—Ç–µ –≤ –Ω–µ–º —Ç—Ä–∏ –æ—Å–Ω–æ–≤–Ω—ã–µ —Å–µ–∫—Ü–∏–∏:

```html
<!-- –°–ï–ö–¶–ò–Ø 1: –°–¢–ò–õ–ò -->
<style>
    .main-ctr { ... }
    .hdr { ... }
    /* ... ~8530 —Å—Ç—Ä–æ–∫ ... */
</style>

<!-- –°–ï–ö–¶–ò–Ø 2: HTML -->
<div class="main-ctr">
    <!-- ... —Ä–∞–∑–º–µ—Ç–∫–∞ ... -->
</div>

<!-- –°–ï–ö–¶–ò–Ø 3: JAVASCRIPT -->
<script>
(function() {
    'use strict';
    const QE = {};
    /* ... ~6000 —Å—Ç—Ä–æ–∫ ... */
})();
</script>
```

---

### –®–ê–ì 2: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏ –∞–¥–∞–ø—Ç–∞—Ü–∏—è —Å—Ç–∏–ª–µ–π (5 –º–∏–Ω—É—Ç)

#### 2.1 –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –í–°–ï —Å—Ç–∏–ª–∏

```bash
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ —Å—Ç–∏–ª–µ–π
sed -n '/<style>/,/<\/style>/p' your-quote-editor.html | sed '1d;$d' > extracted-styles.css
```

**–ò–ª–∏ –≤—Ä—É—á–Ω—É—é:**
1. –ù–∞–π–¥–∏—Ç–µ `<style>` –≤ –≤–∞—à–µ–º —Ñ–∞–π–ª–µ
2. –í—ã–¥–µ–ª–∏—Ç–µ –í–°–Å –¥–æ `</style>`
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ (–±–µ–∑ —Ç–µ–≥–æ–≤ `<style>` –∏ `</style>`)

#### 2.2 –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å

```bash
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø—Ä–∏–º–µ—Ä–Ω–æ 8530 —Å—Ç—Ä–æ–∫
wc -l extracted-styles.css

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –Ω–µ—Ç —Ç–µ–≥–æ–≤ <style>
grep -c "<style>" extracted-styles.css  # –î–æ–ª–∂–Ω–æ –±—ã—Ç—å 0
```

---

### –®–ê–ì 3: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ HTML (5 –º–∏–Ω—É—Ç)

#### 3.1 –°–∫–æ–ø–∏—Ä—É–π—Ç–µ HTML —Ä–∞–∑–º–µ—Ç–∫—É

```bash
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ (–Ω–∞—á–∏–Ω–∞—è —Å main-ctr)
sed -n '/<div class="main-ctr">/,/<\/div>/p' your-quote-editor.html > extracted-html.html
```

**–ò–ª–∏ –≤—Ä—É—á–Ω—É—é:**
1. –ù–∞–π–¥–∏—Ç–µ `<div class="main-ctr">`
2. –í—ã–¥–µ–ª–∏—Ç–µ –í–°–Å –¥–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ –∑–∞–∫—Ä—ã–≤–∞—é—â–µ–≥–æ `</div>` (–æ–±—ã—á–Ω–æ –≤ —Å–∞–º–æ–º –∫–æ–Ω—Ü–µ HTML)
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ

#### 3.2 –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –µ—Å—Ç—å:
- `<canvas id="qcanvas">`
- `<textarea id="txtQuote">`
- `<input id="writer">`
- –í—Å–µ –∫–Ω–æ–ø–∫–∏ –∏ —ç–ª–µ–º–µ–Ω—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

---

### –®–ê–ì 4: –ê–¥–∞–ø—Ç–∞—Ü–∏—è JavaScript (20 –º–∏–Ω—É—Ç)

–≠—Ç–æ —Å–∞–º—ã–π –≤–∞–∂–Ω—ã–π —à–∞–≥!

#### 4.1 –°–æ–∑–¥–∞–π—Ç–µ –∞–¥–∞–ø—Ç–µ—Ä—ã —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤

**–í –Ω–∞—á–∞–ª–µ –≤–∞—à–µ–≥–æ JavaScript –∫–æ–¥–∞ –Ω–∞–π–¥–∏—Ç–µ:**
```javascript
const QE = {};
```

**–ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞:**
```javascript
const QE = {};

// –ê–¥–∞–ø—Ç–µ—Ä—ã –¥–ª—è Shadow DOM
QE.get = function(id) {
    return shadowRoot.getElementById(id);
};

QE.qs = function(selector) {
    return shadowRoot.querySelector(selector);
};

QE.qsAll = function(selector) {
    return shadowRoot.querySelectorAll(selector);
};
```

#### 4.2 –ó–∞–º–µ–Ω–∏—Ç–µ –≤—Å–µ document.getElementById

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–º–µ–Ω–∞:**
```bash
# –°–æ–∑–¥–∞–π—Ç–µ –∫–æ–ø–∏—é JavaScript
cp extracted-javascript.js extracted-javascript-converted.js

# –ó–∞–º–µ–Ω–∏—Ç–µ –≤—Å–µ –≤—Ö–æ–∂–¥–µ–Ω–∏—è
sed -i 's/document\.getElementById/QE.get/g' extracted-javascript-converted.js
```

**–ò–ª–∏ –≤—Ä—É—á–Ω—É—é –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ:**
- –ù–∞–π—Ç–∏: `document.getElementById\(`
- –ó–∞–º–µ–Ω–∏—Ç—å –Ω–∞: `QE.get(`

**–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–º–µ–Ω:**
```bash
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å ~150-200 –≤—Ö–æ–∂–¥–µ–Ω–∏–π
grep -c "QE.get(" extracted-javascript-converted.js
```

#### 4.3 –ó–∞–º–µ–Ω–∏—Ç–µ document.querySelector

```bash
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–º–µ–Ω–∞
sed -i 's/document\.querySelector\(/QE.qs(/g' extracted-javascript-converted.js

# –ü—Ä–æ–≤–µ—Ä–∫–∞
grep -c "QE.qs(" extracted-javascript-converted.js
```

#### 4.4 –ó–∞–º–µ–Ω–∏—Ç–µ document.querySelectorAll

```bash
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–º–µ–Ω–∞
sed -i 's/document\.querySelectorAll\(/QE.qsAll(/g' extracted-javascript-converted.js

# –ü—Ä–æ–≤–µ—Ä–∫–∞
grep -c "QE.qsAll(" extracted-javascript-converted.js
```

#### 4.5 –û–±—Ä–∞–±–æ—Ç–∞–π—Ç–µ DOMContentLoaded

**–ù–∞–π–¥–∏—Ç–µ:**
```javascript
document.addEventListener('DOMContentLoaded', function() {
    // –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
});
```

**–ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞:**
```javascript
// –í–º–µ—Å—Ç–æ DOMContentLoaded –∏—Å–ø–æ–ª—å–∑—É–µ–º IIFE (Immediately Invoked Function Expression)
(function init() {
    // –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
})();
```

#### 4.6 –û–±—Ä–∞–±–æ—Ç–∞–π—Ç–µ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è

**–û—Å—Ç–∞–≤—å—Ç–µ –Ω–∞ document:**
- `paste` - –≤—Å—Ç–∞–≤–∫–∞ –∏–∑ –±—É—Ñ–µ—Ä–∞
- `resize` - –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞
- `scroll` - –ø—Ä–æ–∫—Ä—É—Ç–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- `keydown` / `keyup` - –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –∫–ª–∞–≤–∏—à–∏

**–ü–µ—Ä–µ–Ω–µ—Å–∏—Ç–µ –Ω–∞ shadowRoot:**
- `click` –≤–Ω—É—Ç—Ä–∏ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞
- `input` / `change` –≤ —Ñ–æ—Ä–º–∞—Ö
- –õ–æ–∫–∞–ª—å–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤

**–ü—Ä–∏–º–µ—Ä:**
```javascript
// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - –≥–ª–æ–±–∞–ª—å–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ
document.addEventListener('paste', function(e) {
    // ...
});

// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - –ª–æ–∫–∞–ª—å–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ
shadowRoot.addEventListener('click', function(e) {
    // ...
});
```

---

### –®–ê–ì 5: –°–±–æ—Ä–∫–∞ –∏—Ç–æ–≥–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞ (10 –º–∏–Ω—É—Ç)

#### 5.1 –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —à–∞–±–ª–æ–Ω

–û—Ç–∫—Ä–æ–π—Ç–µ `dle-integration-template.html` –∏ –≤—Å—Ç–∞–≤—å—Ç–µ:

**–°–µ–∫—Ü–∏—è STYLES:**
```html
<style>
    /* –í–°–¢–ê–í–¨–¢–ï extracted-styles.css –°–Æ–î–ê */
</style>
```

**–°–µ–∫—Ü–∏—è HTML:**
```html
<!-- –í–°–¢–ê–í–¨–¢–ï extracted-html.html –°–Æ–î–ê -->
```

**–°–µ–∫—Ü–∏—è JAVASCRIPT:**
```javascript
// –í–°–¢–ê–í–¨–¢–ï extracted-javascript-converted.js –°–Æ–î–ê
```

#### 5.2 –î–æ–±–∞–≤—å—Ç–µ —ç–∫—Å–ø–æ—Ä—Ç

–í —Å–∞–º–æ–º –∫–æ–Ω—Ü–µ JavaScript (–ø–µ—Ä–µ–¥ –∑–∞–∫—Ä—ã–≤–∞—é—â–∏–º `})();`) –¥–æ–±–∞–≤—å—Ç–µ:

```javascript
// –≠–∫—Å–ø–æ—Ä—Ç –¥–ª—è –≤–Ω–µ—à–Ω–µ–≥–æ –¥–æ—Å—Ç—É–ø–∞
window.QuoteEditorInstance = {
    shadowRoot: shadowRoot,
    QE: QE,

    getCanvas: function() {
        return QE.get('qcanvas');
    },

    getQuoteText: function() {
        return QE.get('txtQuote')?.value || '';
    },

    regenerate: function() {
        QE.genImg();
    }
};
```

---

### –®–ê–ì 6: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (15 –º–∏–Ω—É—Ç)

#### 6.1 –û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ª–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å Python)
python3 -m http.server 8000

# –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ª—é–±–æ–π –¥—Ä—É–≥–æ–π –≤–µ–±-—Å–µ—Ä–≤–µ—Ä
# –ó–∞—Ç–µ–º –æ—Ç–∫—Ä–æ–π—Ç–µ: http://localhost:8000/quote-editor-isolated.html
```

#### 6.2 –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞

–û—Ç–∫—Ä–æ–π—Ç–µ DevTools (`F12`) –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

```javascript
// –î–æ–ª–∂–Ω–æ –±—ã—Ç—å —É—Å–ø–µ—à–Ω–æ
‚úÖ Shadow DOM initialized
‚úÖ Quote Editor initialized

// –ù–ï –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—à–∏–±–æ–∫
‚ùå Cannot read property 'getElementById' of null
‚ùå shadowRoot is not defined
```

#### 6.3 –¢–µ—Å—Ç –∏–∑–æ–ª—è—Ü–∏–∏ —Å—Ç–∏–ª–µ–π

```javascript
// –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
const outsideDiv = document.querySelector('body');
const insideCanvas = window.QuoteEditorInstance.shadowRoot.querySelector('#qcanvas');

const outsideStyle = window.getComputedStyle(outsideDiv);
const insideStyle = window.getComputedStyle(insideCanvas);

console.log('Outside background:', outsideStyle.backgroundColor);
console.log('Inside background:', insideStyle.backgroundColor);

// –ï—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏—è –†–ê–ó–ù–´–ï - –∏–∑–æ–ª—è—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç! ‚úÖ
```

#### 6.4 –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏:
- [ ] –í–≤–æ–¥ —Ç–µ–∫—Å—Ç–∞ —Ü–∏—Ç–∞—Ç—ã
- [ ] –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ–Ω–æ–≤–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- [ ] –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ canvas
- [ ] –°–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
- [ ] –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º (–ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞)
- [ ] –†–µ–∂–∏–º –æ–±—Ä–µ–∑–∫–∏
- [ ] –§–∏–ª—å—Ç—Ä—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- [ ] –°—Ç–∏–∫–µ—Ä—ã
- [ ] API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ (—Ñ–∏–ª—å–º—ã, –º—É–∑—ã–∫–∞, Pexels)

---

### –®–ê–ì 7: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ DLE (5 –º–∏–Ω—É—Ç)

#### 7.1 –û—Ç–∫—Ä–æ–π—Ç–µ –Ω—É–∂–Ω—ã–π DLE —à–∞–±–ª–æ–Ω

–ù–∞–ø—Ä–∏–º–µ—Ä, `fullstory.tpl` –∏–ª–∏ `addnews.tpl`

#### 7.2 –í—Å—Ç–∞–≤—å—Ç–µ –∫–æ–¥

**–í `<head>` –∏–ª–∏ –ø–µ—Ä–µ–¥ `</body>`:**

```html
<!-- –í–Ω–µ—à–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –ü–ï–†–ï–î Shadow DOM -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

<!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä -->
<div id="quote-editor-isolated"></div>

<!-- –í–∞—à –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥ -->
<script>
(function() {
    const container = document.getElementById('quote-editor-isolated');
    const shadowRoot = container.attachShadow({ mode: 'open' });

    shadowRoot.innerHTML = `
        <style>/* –≤–∞—à–∏ —Å—Ç–∏–ª–∏ */</style>
        <!-- –≤–∞—à HTML -->
    `;

    const QE = {};
    QE.get = (id) => shadowRoot.getElementById(id);
    // ... –≤–µ—Å—å –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ ...
})();
</script>
```

#### 7.3 –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ

1. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —à–∞–±–ª–æ–Ω DLE
2. –û–±–Ω–æ–≤–∏—Ç–µ –∫—ç—à DLE
3. –û—Ç–∫—Ä–æ–π—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤ –±—Ä–∞—É–∑–µ—Ä–µ
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ä–µ–¥–∞–∫—Ç–æ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω –æ—Ç DLE —Å—Ç–∏–ª–µ–π

---

## ‚úÖ –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–π —á–µ–∫–ª–∏—Å—Ç

–ü–µ—Ä–µ–¥ —Ñ–∏–Ω–∞–ª—å–Ω—ã–º –∑–∞–ø—É—Å–∫–æ–º —É–±–µ–¥–∏—Ç–µ—Å—å:

### –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ
- [ ] –°—Ç–∏–ª–∏ –∏–∑–≤–ª–µ—á–µ–Ω—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫)
- [ ] HTML –∏–∑–≤–ª–µ—á–µ–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é (–µ—Å—Ç—å –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã)
- [ ] JavaScript –∏–∑–≤–ª–µ—á–µ–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é

### –ê–¥–∞–ø—Ç–∞—Ü–∏—è
- [ ] –í—Å–µ `document.getElementById` ‚Üí `QE.get`
- [ ] –í—Å–µ `document.querySelector` ‚Üí `QE.qs`
- [ ] –í—Å–µ `document.querySelectorAll` ‚Üí `QE.qsAll`
- [ ] `DOMContentLoaded` –∑–∞–º–µ–Ω–µ–Ω –Ω–∞ IIFE
- [ ] –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –æ—Å—Ç–∞–ª–∏—Å—å –Ω–∞ `document`
- [ ] –õ–æ–∫–∞–ª—å–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –Ω–∞ `shadowRoot`

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- [ ] –í–Ω–µ—à–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –î–û Shadow DOM
- [ ] –°–æ–∑–¥–∞–Ω –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è Shadow DOM
- [ ] –°—Ç–∏–ª–∏ –≤—Å—Ç–∞–≤–ª–µ–Ω—ã –≤ Shadow DOM
- [ ] HTML –≤—Å—Ç–∞–≤–ª–µ–Ω –≤ Shadow DOM
- [ ] JavaScript –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –≠–∫—Å–ø–æ—Ä—Ç API –¥–ª—è –≤–Ω–µ—à–Ω–µ–≥–æ –¥–æ—Å—Ç—É–ø–∞

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] –ù–µ—Ç –æ—à–∏–±–æ–∫ –≤ –∫–æ–Ω—Å–æ–ª–∏
- [ ] Canvas –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
- [ ] –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –°–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ò–∑–æ–ª—è—Ü–∏—è —Å—Ç–∏–ª–µ–π —Ä–∞–±–æ—Ç–∞–µ—Ç (–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ)
- [ ] –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ —Ä–∞–±–æ—Ç–∞—é—Ç

---

## üêõ Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: "shadowRoot is not defined"

**–ü—Ä–∏—á–∏–Ω–∞:** –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è `shadowRoot` –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ –≤ –æ–±–ª–∞—Å—Ç–∏ –≤–∏–¥–∏–º–æ—Å—Ç–∏

**–†–µ—à–µ–Ω–∏–µ:**
```javascript
// –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–µ—Å—å –∫–æ–¥ –≤–Ω—É—Ç—Ä–∏ –∑–∞–º—ã–∫–∞–Ω–∏—è:
(function() {
    const shadowRoot = container.attachShadow({ mode: 'open' });

    // –í–°–Å –æ—Å—Ç–∞–ª—å–Ω–æ–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –ó–î–ï–°–¨

})();
```

### –ü—Ä–æ–±–ª–µ–º–∞: "Cannot read property 'getElementById' of null"

**–ü—Ä–∏—á–∏–Ω–∞:** –û–±—Ä–∞—â–µ–Ω–∏–µ –∫ `shadowRoot.getElementById` –¥–æ —Å–æ–∑–¥–∞–Ω–∏—è Shadow DOM

**–†–µ—à–µ–Ω–∏–µ:**
```javascript
// –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –ø–æ—Ä—è–¥–∫–µ:
const shadowRoot = container.attachShadow({ mode: 'open' });  // 1. –°–æ–∑–¥–∞–Ω–∏–µ
shadowRoot.innerHTML = `...`;                                  // 2. –ù–∞–ø–æ–ª–Ω–µ–Ω–∏–µ
const canvas = shadowRoot.getElementById('qcanvas');           // 3. –î–æ—Å—Ç—É–ø
```

### –ü—Ä–æ–±–ª–µ–º–∞: –°—Ç–∏–ª–∏ –Ω–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è

**–ü—Ä–∏—á–∏–Ω–∞:** –°—Ç–∏–ª–∏ –≤—Å—Ç–∞–≤–ª–µ–Ω—ã –ü–û–°–õ–ï HTML

**–†–µ—à–µ–Ω–∏–µ:**
```javascript
shadowRoot.innerHTML = `
    <style>/* –°–ù–ê–ß–ê–õ–ê */</style>
    <div><!-- –ü–û–¢–û–ú --></div>
`;
```

### –ü—Ä–æ–±–ª–µ–º–∞: –°–æ–±—ã—Ç–∏—è –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç

**–ü—Ä–∏—á–∏–Ω–∞:** –û–±—Ä–∞—â–µ–Ω–∏–µ –∫ —ç–ª–µ–º–µ–Ω—Ç–∞–º —á–µ—Ä–µ–∑ `document` –≤–º–µ—Å—Ç–æ `shadowRoot`

**–†–µ—à–µ–Ω–∏–µ:**
```javascript
// ‚ùå –ù–ï –†–ê–ë–û–¢–ê–ï–¢
document.getElementById('myButton').addEventListener(...);

// ‚úÖ –†–ê–ë–û–¢–ê–ï–¢
shadowRoot.getElementById('myButton').addEventListener(...);

// ‚úÖ –ò–õ–ò
QE.get('myButton').addEventListener(...);
```

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

### –§–∞–π–ª—ã –≤ —ç—Ç–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏

- `convert.sh` - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–∫—Ä–∏–ø—Ç –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏
- `dle-integration-template.html` - –≥–æ—Ç–æ–≤—ã–π —à–∞–±–ª–æ–Ω –¥–ª—è DLE
- `example-usage.html` - –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- `README.md` - –æ–±—â–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã

```bash
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è
./convert.sh your-file.html

# –ó–∞–ø—É—Å–∫ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
python3 -m http.server 8000

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–º–µ–Ω
grep -c "QE.get(" converted-file.js
grep -c "QE.qs(" converted-file.js

# –ü–æ–∏—Å–∫ –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è document.getElementById
grep "document\.getElementById" converted-file.js
```

---

## üéì –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏ —É –≤–∞—Å –±—É–¥–µ—Ç:

‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–µ–¥–∞–∫—Ç–æ—Ä —Ü–∏—Ç–∞—Ç
‚úÖ –ù–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ —Å DLE —Å—Ç–∏–ª—è–º–∏
‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –ª—é–±–æ–π —à–∞–±–ª–æ–Ω
‚úÖ –î–æ—Å—Ç—É–ø –∫ API –¥–ª—è –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
‚úÖ –°–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –Ω–∞ –±–∞–∑–µ Web Components

---

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~60 –º–∏–Ω—É—Ç
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –°—Ä–µ–¥–Ω—è—è
**–¢—Ä–µ–±—É–µ–º—ã–µ –Ω–∞–≤—ã–∫–∏:** –ë–∞–∑–æ–≤–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ HTML/CSS/JavaScript

**–£–¥–∞—á–∏ —Å –º–∏–≥—Ä–∞—Ü–∏–µ–π! üöÄ**
